<tool id="digestdb" version="0.1.0" name="Digest Database">
  <description>Perform a theoretical digest of a protein database.</description>
  <requirements>
    <requirement type="package">transproteomic_pipeline</requirement>    
  </requirements>  
  <command>
    digestdb -m$missed_cleavages -l$min_mass -h$max_mass -r${str($enzyme).split(":")[0]} -n${str($enzyme).split(":")[1]} $sequences > $output
  </command>
  <inputs>
    <param format="fasta" name="sequences" type="data" label="Input FASTA Database"/>
    <param name="missed_cleavages" type="integer" label="Missed Cleavages" value="1"/>
    <param name="min_mass" type="float" label="Minimum Peptide Mass" value="800.0"/>
    <param name="max_mass" type="float" label="Maximum Peptide Mass" value="3000.0"/>
    <param name="enzyme" type="select">
      <option value="KR:P" selected="true">Trypsin</option>
      <option value="KR:-">Trypsin/P</option>
      <option value="FLWY:P">Chymotrypsin</option>
      <option value="FLWY:-">Chymotrypsin/P</option>
      <option value="EZ:P">V8_E</option>
      <option value="EDBZ:P">V8_DE</option>
      <option value="K:P">LysC</option>
      <option value="K:-">LysC/P</option>
    </param>
  </inputs>
  <outputs>
    <data format="tabular" name="output" label="Digest of database ${sequences.name}"/>
  </outputs>
  <help>
**What it does**

Produces a tabular description of peptides resulting from theoretical
digest of a given protein database by the selected enzyme agent using
the digestdb program distributed with the Transproteomic Pipeline.

** digestdb Documentation ** 

 DIGEST PROGRAM, J.Eng

 USAGE:   digestdb [options] database_file

 Command line options:
    -l<num>     set minimum peptide mass (<num> is a float; default=800.00)
    -h<num>     set maximum peptide mass (<num> is a float; default=3000.00)
    -m<num>     set number of missed cleavages (<num> is an int; default=1)

    -r<str>     residues to cleave after (default="RK" for trypsin)
    -n<str>     don't cleave if next AA (default="P" for trypsin)
                ** only c-term cleavages are support right now so there's no AspN digestion.
                ** use a dash (-) or leave <str> blank for a null character.
    -M<str>     static modifications, comma separated of form <mass>@<residue>
                   for example -M57.021@C,15.995@M

    -t<num>     mass type, 0=average, 1=monoisotopic (default)

 For example:  digestdb ipi.fasta
               digestdb -m3 ipi.fasta       (allow up to 3 missed cleavages)
               digestdb -l800.0 -h1000.0 ipi.fasta    (set mass range from 800.0 to 1000.0)
               digestdb -rDE -nP ipi.fasta  (glu-C protease cuts after D/E but no if followed by P)

 Results are spit out to stdout in a tab-delimited format.
 Redirect the output if you want them stored in a file.

     For example:  digestdb ipi.fasta > digest.txt

 To only get keep certain columns, use the 'awk' command.  For example, to print
 only the 2nd (protein), 3rd (mass), and 5th (peptide) columns, type
    digestdb ipi.fasta | awk '{print $2 "\t" $3 "\t" $4}' > digest.txt

 Asterisks (*) in sequence are treated as proper break points

 Output columns:
 - peptide length
 - protein reference
 - peptide mass
 - previous amino acid before peptide
 - peptide sequence
 - next amino acid after peptide
 - peptide start location
 - peptide end location
 - pI


------

**Citation**

For the underlying tool, please cite `Proteomics. 2010 Mar;10(6):1150-9. A guided tour of the Trans-Proteomic Pipeline. Deutsch EW, Mendoza L, Shteynberg D, Farrah T, Lam H, Tasman N, Sun Z, Nilsson E, Pratt B, Prazen B, Eng JK, Martin DB, Nesvizhskii AI, Aebersold R. PMID 20101611`

If you use this tool in Galaxy, please cite Chilton J, et al. https://bitbucket.org/galaxyp/galaxyp-toolshed-digestdb

  </help>
</tool>
