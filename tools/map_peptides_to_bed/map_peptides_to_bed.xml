<tool id="map_peptides_to_bed" name="Map peptides to a bed file" version="0.1.0">
    <requirements>
        <requirement type="package" version="1.62">biopython</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
        map_peptides_to_bed.py 
          --translated_bed="$translated_bed" 
          --input="$input" 
          #if $peptide_column:
            --peptide_column=$peptide_column 
          #end if
          #if $name_column:
            --name_column=$name_column
          #end if
          #if $start_column:
            --start_column=$start_column
          #end if
          $gffTags
          --bed="$mapped_peptides"
    ]]></command>
    <inputs>
        <param name="translated_bed" type="data" format="bed" label="Translated bed with IDs to match in the input" help=""/>
        <param name="input" type="data" format="tabular" label="Identified Peptides" help=""/>
        <param name="peptide_column" type="data_column" data_ref="input" label="peptide column" optional="true" 
               help="Defaults to first column"/>
        <param name="name_column" type="data_column" data_ref="input" label="protein name column" optional="true" 
               help="The name in this column must match the name column in the Translate bed"/>
        <param name="start_column" type="data_column" data_ref="input" label="peptide offset column" optional="true" 
               help="The offset in AnimoAcids of the peptide from the start of the protein sequence"/>
        <param name="gffTags" type="boolean" truevalue="--gffTags" falsevalue="" checked="true" label="Use #gffTags in output" help=""/>
    </inputs>
    <outputs>
        <data name="mapped_peptides" format="bed" />
    </outputs>
    <tests>
        <test>
            <param name="translated_bed" type="data" ftype="bed" value="translated_bed_sequences.bed"/>
            <param name="input" type="data" ftype="tabular" value="peptides.tsv"/>
            <param name="peptide_column" value="2"/>
            <param name="name_column" value="1"/>
            <output name="mapped_peptides" file="mapped_peptides.bed"/>
        </test>
    </tests>
    <help><![CDATA[
        Usage: map_peptides_to_bed.py [options]

Options:
  -h, --help            show this help message and exit
  -t TRANSLATED_BED, --translated_bed=TRANSLATED_BED
                        A bed file with added 13th column having a translation
  -i INPUT, --input=INPUT
                        Tabular file with peptide_sequence column
  -p PEPTIDE_COLUMN, --peptide_column=PEPTIDE_COLUMN
                        column ordinal with peptide sequence
  -n NAME_COLUMN, --name_column=NAME_COLUMN
                        column ordinal with protein name
  -s START_COLUMN, --start_column=START_COLUMN
                        column with peptide start position in protein
  -B BED, --bed=BED     Output a bed file with added 13th column having
                        translation
  -T, --gffTags         Add #gffTags to bed output for IGV
  -d, --debug           Turn on wrapper debugging to stderr

    ]]></help>
</tool>
