<tool id="pi_db_split" name="Split peptide database" version="1.0">
    <description>into pI separated fractions</description>
    <command>
	    mkdir pi_fr_out; cd pi_fr_out;
	    python3 $__tool_directory__/pi_database_splitter.py -i $pipeptides -p $peptable
            --intercept $intercept --width $fr_width --tolerance $tolerance --amount $fr_amount --prefix pisplit
            --deltacol $deltacol --picutoff $picutoff --fdrcol $fdrcol --fdrcutoff $fdrcutoff 
            #if $reverse
            --reverse
            #end if
            --tmpdir /tmp	    
    </command>
    
    <inputs>
      <param name="pipeptides" type="data" format="tabular" label="Undefined target peptides with annotation of pI and protein match" />
      <param name="peptable" type="data" format="tabular" label="Peptide table to determine pI shift from" help="Should have delta pI as a column" />
      <param name="fdrcol" type="integer" value="" label="FDR (q-value) column in peptide table" />
      <param name="fdrcutoff" type="float" value="0" label="FDR value cutoff for inclusion in shift determination" />
      <param name="deltacol" type="integer" value="" label="Delta pI column in peptide table" />
      <param name="picutoff" type="float" value="0" label="delta-pI cutoff for inclusion in shift determination" />
      <param name="intercept" type="float" value="" label="Intercept of pI strip" />
      <param name="fr_width" type="float" value="" label="Fraction width" />
      <param name="tolerance" type="float" value="" label="pI tolerance" />
      <param name="fr_amount" type="integer" value="" label="Fraction amount" />
      <param name="reverse" type="boolean" label="Strip is reversed (high-to-low pI)?" />
    </inputs>
    
    <outputs>
	<collection name="target_pi_db" type="list" label="target pI separated db">
            <discover_datasets pattern="pisplit_(?P&lt;designation&gt;.+)\.fasta" ext="fasta" directory="pi_fr_out" />
	</collection>
	<collection name="decoy_pi_db" type="list" label="decoy pI separated db">
            <discover_datasets pattern="decoy_pisplit_(?P&lt;designation&gt;.+)\.fasta" ext="fasta" directory="pi_fr_out" />
	</collection>
    </outputs>
    <tests>
    </tests>

    <help>
	    Creates a pI separated database collection from a pI-determined input
	    file of peptide/protein mappings. Outputs one db for target, one
	    for decoy.
    </help>

</tool>
