<?xml version="1.0"?>
<tool_dependency>
    <package name="sqlite" version="3.8.3">
        <repository name="package_sqlite_3_8_3" owner="iuc" prior_installation_required="True" />
    </package>
    <package name="boost" version="1.57.0">
        <repository name="package_boost_1_57" owner="iuc" prior_installation_required="True" />
    </package>
    <package name="cmake" version="3.2.3">
        <repository name="package_cmake_3_2_3" owner="iuc" prior_installation_required="True" />
    </package>
    <package name="zlib" version="1.2.8">
        <repository name="package_zlib_1_2_8" owner="iuc" prior_installation_required="True" />
    </package>
    <package name="bzlib" version="1.0.6">
        <repository name="package_bzlib_1_0" owner="iuc" prior_installation_required="True" />
    </package>
    <package name="xerces-c" version="3.1.1">
        <install version="1.0">
            <actions>
		<action type="download_by_url" md5sum="6a8ec45d83c8cfb1584c5a5345cb51ae">http://archive.apache.org/dist/xerces/c/3/sources/xerces-c-3.1.1.tar.gz</action>
		<action type="shell_command">./configure --disable-network --disable-threads --disable-shared --enable-static</action>
		<action type="change_directory">./src</action>
		<action type="shell_command">make &amp;&amp; ln -s .libs/libxerces-c.a . &amp;&amp; ranlib libxerces-c.a</action>
		<action type="set_environment">
			<environment_variable name="XERCES_DIR" action="set_to">.</environment_variable>
		</action>
            </actions>
	</install>
    </package>
    <package name="xsd" version="4.0.0+dep">
        <install version="1.0">
            <actions>
	        <action type="set_environment_for_install">
	            <repository name="package_percolator_2_10" owner="galaxyp">
	                <package name="xerces-c" version="3.1.1" />
	            </repository>
                </action>
		<action type="download_by_url" sha1sum="ad3de699eb140e747a0a214462d95fc81a21b494">http://codesynthesis.com/download/xsd/4.0/xsd-4.0.0+dep.tar.bz2</action>
		<action type="shell_command">make CPPFLAGS=-I$XERCES_DIR/src LDFLAGS=-L$XERCES_DIR/src/.libs</action>
		<action type="shell_command">mkdir bin; mv ./xsd/xsd/xsd ./bin</action>
                <action type="set_environment">
			<environment_variable name="XSD_DIR" action="set_to">.</environment_variable>
		</action>
		<!-- FIXME check if have to do sed on the push_back thing like buildscripts do for ubuntu and fedora but not for centos -->
            </actions>
	</install>
    </package>
    <package name="tokyocabinet" version="1.4.48">
        <install version="1.0">
            <actions>
		<action type="download_by_url">http://fallabs.com/tokyocabinet/tokyocabinet-1.4.48.tar.gz</action>
		<action type="shell_command">./configure</action>
		<action type="shell_command">make</action>
		<action type="shell_command">make install</action>
            </actions>
	</install>
    </package>
    <package name="percolator" version="2.10">
        <install version="1.0">
                <actions>
                    <action type="download_by_url" target_filename="percolator.tar.gz">https://github.com/percolator/percolator/archive/rel-2-10.tar.gz</action>
		    <action type="set_environment_for_install">
		        <repository name="package_boost_1_57" owner="iuc">
			    <package name="boost" version="1.57.0" />
			</repository>
                    </action>
		    <action type="set_environment_for_install">
		        <repository name="package_percolator_2_10" owner="galaxyp">
			    <package name="xerces-c" version="3.1.1" />
			</repository>
                    </action>
		    <action type="set_environment_for_install">
		        <repository name="package_percolator_2_10" owner="galaxyp">
			    <package name="xsd" version="4.0.0+dep" />
			</repository>
                    </action>
		    <action type="shell_command">mkdir build &amp;&amp; cd build</action>
		    <action type="shell_command">cmake -DTARGET_ARCH=x86_64 -DCMAKE_BUILD_TYPE=Release -DXML_SUPPORT=ON -DBOOST_ROOT=$BOOST_ROOT_DIR -DBOOST_LIBRARYDIR=$BOOST_ROOT_DIR/lib -DCMAKE_PREFIX_PATH="$XERCES_DIR/src;$XSD_DIR$" ../</action>
		    <action type="shell_command">make &amp;&amp; cp percolator $INSTALL_DIR/percolator &amp;&amp; cd ../</action>
		    <action type="shell_command">mkdir build_converters &amp;&amp; cd build_converters</action>
		    <action type="shell_command">cmake -DTARGET_ARCH=x86_64 -DCMAKE_BUILD_TYPE=Release -DBOOST_ROOT=$BOOST_ROOT_DIR -DBOOST_LIBRARYDIR=$BOOST_ROOT_DIR/lib -DSERIALIZE="TokyoCabinet" -DCMAKE_PREFIX_PATH="$XERCES_DIR/src;$XSD_DIR$" ../src/converters</action>
		    <action type="shell_command">make &amp;&amp; cp *2pin $INSTALL_DIR/</action>
                </actions>
        </install>
        <readme>
            Install Galaxy package application for percolator 2.10
            http://github.com/percolator/percolator/
        </readme>
    </package>
</tool_dependency>
